BLE bietet einige Sicherheitsfunktionen, die durch den Security Manager bzw. das Security Manager Protocol (siehe Sektion \ref{sec: le sm}) zur Verfügung gestellt werden. Jedoch sind diese nicht ausreichend, um diese Infrastruktur zu schützen. Zudem sind sie abhängig von den Ein- und Ausgabeoptionen, die die kommunizierenden Geräte (Mikrocontroller und Smartphone) unterstützen. In Sektion \ref{sec: le security} werden die konkreten Mängel hervorgehoben. Dabei ist eine der kritischsten Sicherheitslücken die nicht vorhandene Sicherheit auf Anwendungsebene, die für die Infrastruktur unbedingt bestehen muss, da sonst im System des Smartphones Software Dritter auf die Daten der eigenen Anwendung zugreifen kann.

\subsubsection{Transport Layer Security}
Eine selbsterstellte kryptographische Implementierung für den Schutz des Transports wäre sehr aufwendig und würde vermutlich nie einen zuverlässigen Schutz bieten. Stattdessen sollte auf bewährte Lösungen von professionellen Organisationen gesetzt werden. Ein äußerst weitverbreitetes Protokoll zum Schutz eines Transports ist das \textit{Transport Layer Security} (TLS) Protocol. Es wird von der \textit{Internet Engineering Task Force} (IETF) entwickelt, wobei die neuste Version 1.3 im August 2018 veröffentlicht wurde.
\\\\
TLS lässt sich im Wesentlichen in zwei Teilprotokolle unterteilen: das Handshake Protocol und das Record Protocol. Das Handshake Protocol dient dem Austausch von Sicherheitsparametern zwischen Client und Server. Dabei einigen sich beide Parteien, welche der gemeinsam unterstützten Cipher Suites (Mengen aus Algorithmen für Verschlüsselung, Schlüsselaustausch, Authentifizierung und Hash"=Funktion) genutzt wird. Zudem authentifiziert der Client den Server, indem er dessen empfangenes Zertifikat verifiziert. Eine beidseitige Authentifikation ist möglich. Wurde das Handshake Protocol erfolgreich abgeschlossen, können Server und Client mithilfe des Record Protocols durch den entsprechenden Algorithmus aus der vereinbarten Cipher Suite nun die Anwendungsdaten verschlüsseln und deren Datenintegrität sicherstellen. Somit erfüllt TLS die in Sektion \ref{sec: infra allg} gesetzten Sicherheitsziele Vertraulichkeit, Datenintegrität und Authentizität / Authentifizierung. \cite{RFC8446_24-33}
\\\\
Weitere Argumente für die Verwendung von TLS sind folgende. TLS ist unabhängig vom Transport Layer, wodurch nicht zwingend Sockets verwendet werden müssen. Zudem existieren viele Software"=Bibliotheken zu TLS, wodurch mehrere Platformen unterstützt werden. Die Ciphersuites können je nach verwendeter Programmierschnittstelle vor der Laufzeit für das Zielsystem beschränkt werden. Außerdem wird für diese Infrastruktur mit TLS der Mangel an Sicherheit auf Anwendungsebene beseitigt, da eine Ende"=zu"=Ende"=Verschlüsselung vorliegt. % TODO wie sicher ist TLS? MITM, abhören; -> kommt auf TLS Version und Cipher Suites an
\\\\
Folglich wird TLS für diese Infrastruktur angewandt. Die Versionen TLS 1.0 und TLS 1.1 sind veraltet und sollten nicht mehr genutzt werden \cite{RFC8996}. Demnach sind die Versionen TLS 1.2 oder bevorzugt TLS 1.3 zu nutzen.

\subsubsection{BLE-Sicherheitsfunktionen}
\label{sec: infra sicherheit ble funktionen}
Das Privacy Feature von BLE erschwert das Verfolgen eines Geräts, indem dessen Adresse zeitlich periodisch geändert wird. Es wäre als zusätzliche Funktion denkbar, da TLS keinen Einfluss auf die BLE"=Architektur nehmen kann und somit nicht auf die Darstellung der Bluetooth-Adressen. Jedoch ist das Privacy Feature wie in Sektion \ref{sec: le sm phase 3} beschrieben Teil der dritten Phase des Pairings und das Pairing sollte nicht verwendet werden. Unabhängig davon, welche Pairing"=Methode verwendet wird, würden die Anwendungsdaten der Pakete im Link Layer verschlüsselt werden. Jedoch bietet eine weitere Verschlüsselung neben der von TLS keinen Mehrwert für die Sicherheit der Infrastruktur und würde nur mehr Leistung beanspruchen.